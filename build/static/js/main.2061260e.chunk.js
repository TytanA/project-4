(this["webpackJsonpjwt-boilerplate"]=this["webpackJsonpjwt-boilerplate"]||[]).push([[0],{127:function(e,t){},179:function(e,t,n){},180:function(e,t,n){},601:function(e,t,n){},602:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(57),o=n.n(a),c=(n(178),n(179),n(13)),s=n(11),l=(n(180),n(29)),i=n(43),u=n(39),j=n(16),d=n.n(j),h=n(3);function b(e){return Object(h.jsx)("span",{className:"error",children:e.error})}function p(){var e=localStorage.getItem("token");e&&(JSON.parse(atob(e.split(".")[1])).exp<Date.now()/1e3&&(localStorage.removeItem("token"),e=null));return e}var g={setToken:function(e){e?localStorage.setItem("token",e):localStorage.removeItem("token")},getToken:p,removeToken:function(){localStorage.removeItem("token")},getUserFromToken:function(){var e=p();return e?JSON.parse(atob(e.split(".")[1])).user:null}},O="/api/users/";var f={signup:function(e){return fetch(O+"signup",{method:"POST",body:e}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw console.log(e),new Error(e.err)}))})).then((function(e){var t=e.token;return g.setToken(t)}))},logout:function(){g.removeToken()},login:function(e){return fetch(O+"login",{method:"POST",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw console.log(e),new Error(e.err)}))})).then((function(e){var t=e.token;return g.setToken(t)}))},getUser:function(){return g.getUserFromToken()},getProfile:function(e){return fetch(O+e,{headers:{Authorization:"Bearer "+g.getToken()}}).then((function(e){if(e.ok)return e.json();throw new Error("Error from getProfile")}))}},x=n(22),m=(n(184),n(620)),v=n(621),w=n(615),k=n(622),y=n(618),U=n(617);function S(e){var t=Object(r.useState)({message:"",passwordError:!1}),n=Object(c.a)(t,2),a=n[0],o=n[1],j=Object(r.useState)({username:"",email:"",password:"",passwordConf:""}),p=Object(c.a)(j,2),g=p[0],O=p[1],S=Object(r.useState)(""),C=Object(c.a)(S,2),P=C[0],L=C[1];function D(e){O(Object(u.a)(Object(u.a)({},g),{},Object(i.a)({},e.target.name,e.target.value)))}function E(){return(E=Object(l.a)(d.a.mark((function t(n){var r,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),g.password===g.passwordConf){t.next=3;break}return t.abrupt("return",o({message:"Passwords Must Match!",passwordError:!0}));case 3:for(a in(r=new FormData).append("photo",P),g)r.append(a,g[a]);return t.prev=6,t.next=9,f.signup(r);case 9:e.handleSignUpOrLogin(),Object(s.a)("/"),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(6),console.log(t.t0),o({message:t.t0.message});case 17:case"end":return t.stop()}}),t,null,[[6,13]])})))).apply(this,arguments)}return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(m.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(h.jsxs)(m.a.Column,{style:{maxWidth:450},children:[Object(h.jsx)(v.a,{as:"h2",color:"teal",textAlign:"center",children:"Signup for your account"}),Object(h.jsxs)(w.a,{size:"large",onSubmit:function(e){return E.apply(this,arguments)},children:[Object(h.jsxs)(k.a,{stacked:!0,children:[Object(h.jsx)(w.a.Input,{name:"username",placeholder:"username",value:g.username,onChange:D,required:!0}),Object(h.jsx)(w.a.Input,{name:"email",placeholder:"email",value:g.email,onChange:D,required:!0}),Object(h.jsx)(w.a.Input,{icon:"lock",iconPosition:"left",name:"password",placeholder:"password",value:g.password,onChange:D,type:"password",required:!0}),Object(h.jsx)(w.a.Input,{icon:"lock",iconPosition:"left",name:"passwordConf",placeholder:"Confirm Password",value:g.passwordConf,onChange:D,type:"password",required:!0}),Object(h.jsxs)(w.a.Field,{children:[Object(h.jsx)("label",{children:"Upload a Profile Picture"}),Object(h.jsx)(w.a.Input,{type:"file",name:"photo",placeholder:"upload image",onChange:function(e){console.log(e.target.files,"<-this is the uploading file"),L(e.target.files[0])}})]}),Object(h.jsx)(y.a,{type:"submit",color:"teal",fluid:!0,size:"large",children:"Signup"})]}),a.message?Object(h.jsx)(b,{error:a.message}):null]}),Object(h.jsxs)(U.a,{children:["Already a member? ",Object(h.jsx)(x.b,{to:"/login",children:"Login"})]})]})})})}n(601);function C(e){var t=Object(r.useState)(""),n=Object(c.a)(t,2),a=n[0],o=n[1],j=Object(r.useState)({email:"",password:""}),p=Object(c.a)(j,2),g=p[0],O=p[1],S=Object(s.g)();function C(e){O(Object(u.a)(Object(u.a)({},g),{},Object(i.a)({},e.target.name,e.target.value)))}function P(){return(P=Object(l.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.prev=1,t.next=4,f.login(g);case 4:e.handleSignUpOrLogin(),S("/"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0),o(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}return Object(h.jsx)(m.a,{onSubmit:function(e){return P.apply(this,arguments)},textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(h.jsxs)(m.a.Column,{style:{maxWidth:450},children:[Object(h.jsx)(v.a,{as:"h2",color:"teal",textAlign:"center"}),Object(h.jsx)(w.a,{size:"large",children:Object(h.jsxs)(k.a,{stacked:!0,children:[Object(h.jsx)(w.a.Input,{fluid:!0,icon:"user",name:"email",iconPosition:"left",placeholder:"E-mail address",onChange:C,required:!0}),Object(h.jsx)(w.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",name:"password",onChange:C,required:!0}),Object(h.jsx)(y.a,{type:"submit",color:"teal",fluid:!0,size:"large",children:"Login"})]})}),Object(h.jsxs)(U.a,{children:["New to us? ",Object(h.jsx)(x.b,{to:"/signup",children:"Sign Up"})]}),a?Object(h.jsx)(b,{error:a}):null]})})}var P=n(129),L=n(82),D=n(161);function E(e){var t=e.loggedUser,n=e.handleLogout;return console.log(t,"loggedUser in header"),Object(h.jsxs)(k.a,{clearing:!0,children:[Object(h.jsxs)(v.a,{as:"h2",floated:"right",children:[Object(h.jsx)(x.b,{to:"/",children:Object(h.jsx)(L.a,{name:"home"})}),Object(h.jsx)(x.b,{to:"",onClick:n,children:"Logout"})]}),Object(h.jsx)(v.a,{as:"h2",floated:"left",children:Object(h.jsx)(x.b,{to:"/".concat(null===t||void 0===t?void 0:t.username),children:Object(h.jsx)(D.a,{src:null!==t&&void 0!==t&&t.photoUrl?null===t||void 0===t?void 0:t.photoUrl:"https://react.semantic-ui.com/images/wireframe/square-image.png",avatar:!0})})})]})}function T(e){var t=Object(r.useState)({title:"",ingredients:"",directions:""}),n=Object(c.a)(t,2),a=n[0],o=n[1],s=Object(r.useState)(""),l=Object(c.a)(s,2),j=l[0],d=l[1];function b(e){o(Object(u.a)(Object(u.a)({},a),{},Object(i.a)({},e.target.name,e.target.value)))}return Object(h.jsx)(k.a,{children:Object(h.jsxs)(w.a,{onSubmit:function(t){t.preventDefault(),console.log("you are pressing the button");var n=new FormData;for(var r in n.append("photo",j),a)n.append(r,a[r]);e.handleAddPost(n)},children:[Object(h.jsx)(w.a.Input,{className:"form-control",name:"title",value:a.title,placeholder:"What do you call this Disaster?",onChange:b,required:!0}),Object(h.jsx)(w.a.Input,{className:"form-control",name:"ingredients",value:a.ingredients,placeholder:"What are the ingredients and amounts?",onChange:b,required:!0}),Object(h.jsx)(w.a.Input,{className:"form-control",name:"directions",value:a.directions,placeholder:"How do you make this disaster?",onChange:b,required:!0}),Object(h.jsx)(w.a.Field,{children:Object(h.jsx)(w.a.Input,{type:"file",name:"photo",placeholder:"upload image",onChange:function(e){d(e.target.files[0])}})}),Object(h.jsx)(y.a,{type:"submit",className:"btn",children:"Add Disaster"})]})})}var A=n(616);function I(e){var t=e.handleDeletePost,n=e.id;return Object(h.jsx)(y.a,{onClick:function(e){e.preventDefault(),t(n)},className:"btn",children:"Delete"})}function q(e){var t=e.link,n=e.title,r=e.photoUrl,a=e.loggedUser,o=e.username,c=e.id,s=e.handleDeletePost;return console.log(o),console.log(a.username),Object(h.jsxs)(A.a,{children:[Object(h.jsx)(D.a,{src:r,wrapped:!0,ui:!1}),Object(h.jsxs)(A.a.Content,{children:[Object(h.jsx)(x.b,{to:"/posts/".concat(t),children:Object(h.jsx)(A.a.Header,{children:n})}),Object(h.jsx)(A.a.Meta,{}),Object(h.jsx)(A.a.Description,{})]}),Object(h.jsx)(A.a.Content,{extra:!0,children:(null===a||void 0===a?void 0:a.username)===o?Object(h.jsx)(I,{id:c,handleDeletePost:s}):""})]},c)}function z(e){var t=e.posts,n=e.loggedUser,r=e.handleDeletePost;return Object(h.jsx)(A.a.Group,{children:t.map((function(e){return Object(h.jsx)(q,{post:e,id:e._id,title:e.title,photoUrl:e.photoUrl,link:e._id,loggedUser:n,username:e.user.username,handleDeletePost:r})}))})}var N="/api/posts";function F(e){return fetch(N,{method:"POST",body:e,headers:{Authorization:"Bearer "+g.getToken()}}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new Error(e.err)}))}))}function R(e){return fetch("".concat(N,"/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer "+g.getToken()}})}function W(){return fetch(N,{headers:{Authorization:"Bearer "+g.getToken()}}).then((function(e){if(e.ok)return console.log(e),e.json();throw new Error(e.err)}))}function B(e){return console.log("getPost"),fetch(N,+e,{headers:{Authorization:"Bearer "+g.getToken()}}).then((function(e){if(e.ok)return e.json();throw new Error("error from getPost request")}))}function J(e){var t=e.loggedUser,n=e.handleLogout,a=Object(r.useState)([]),o=Object(c.a)(a,2),s=o[0],i=o[1],u=Object(r.useState)(""),j=Object(c.a)(u,2),p=j[0],g=j[1];function O(){return(O=Object(l.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F(t);case 3:n=e.sent,i([n.data].concat(Object(P.a)(s))),f(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),g("Error creating post, please try again");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function f(){return x.apply(this,arguments)}function x(){return(x=Object(l.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W();case 3:t=e.sent,console.log(t," data"),i(Object(P.a)(t.data)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0.message," this is the error");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function v(){return(v=Object(l.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R(t);case 3:n=e.sent,console.log(n,"deleted post"),f(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){f(),console.log("this is the useEffect firing")}),[]),p?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(E,{handleLogout:n,loggedUser:t}),Object(h.jsx)(b,{error:p})]}):Object(h.jsxs)(m.a,{centered:!0,children:[Object(h.jsx)(m.a.Row,{children:Object(h.jsx)(m.a.Column,{children:Object(h.jsx)(E,{handleLogout:n,loggedUser:t})})}),Object(h.jsx)(m.a.Row,{children:Object(h.jsx)(m.a.Column,{children:Object(h.jsx)(T,{handleAddPost:function(e){return O.apply(this,arguments)}})})}),Object(h.jsx)(m.a.Row,{children:Object(h.jsx)(m.a.Column,{style:{maxWidth:450},children:Object(h.jsx)(z,{handleDeletePost:function(e){return v.apply(this,arguments)},posts:s,loggedUser:t})})})]})}function H(e){var t=e.loggedUser,n=e.handleLogout,a=Object(r.useState)({}),o=Object(c.a)(a,2),i=o[0],u=o[1],j=Object(s.h)().id;return console.log(j),Object(r.useEffect)((function(){function e(){return e=Object(l.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B(t);case 3:n=e.sent,u(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),e.apply(this,arguments)}!function(t){e.apply(this,arguments)}()}),[j]),Object(h.jsxs)(m.a,{children:[Object(h.jsx)(m.a.Row,{children:Object(h.jsx)(m.a.Column,{children:Object(h.jsx)(E,{handleLogout:n,loggedUser:t})})}),Object(h.jsx)(m.a.Row,{children:Object(h.jsx)(m.a.Column,{children:i.title})})]})}function M(e){var t=e.user;return Object(h.jsx)(m.a,{textAlign:"center",columns:2,children:Object(h.jsxs)(m.a.Row,{children:[Object(h.jsx)(m.a.Column,{children:Object(h.jsx)(D.a,{src:"".concat(t.photoUrl?t.photoUrl:"https://react.semantic-ui.com/images/wireframe/square-image.png"," "),avatar:!0,size:"small"})}),Object(h.jsx)(m.a.Column,{textAlign:"left",style:{maxWidth:450},children:Object(h.jsx)(k.a,{vertical:!0,children:Object(h.jsx)("h1",{children:t.username})})})]})})}function _(e){var t=e.loggedUser,n=e.handleLogout,a=Object(r.useState)([]),o=Object(c.a)(a,2),i=o[0],u=o[1],j=Object(r.useState)({}),p=Object(c.a)(j,2),g=p[0],O=p[1],x=Object(r.useState)(""),v=Object(c.a)(x,2),w=v[0],k=(v[1],Object(s.h)().username);console.log(k);var y=Object(r.useCallback)(Object(l.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.getProfile(k);case 3:t=e.sent,O(t.data.user),u(t.data.posts),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])}))),[k]);function U(){return(U=Object(l.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R(t);case 3:n=e.sent,console.log(n,"deleted post"),y(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){console.log("profile page use effect"),y()}),[k,y]),w?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(E,{handleLogout:n,loggedUser:t}),Object(h.jsx)(b,{error:w})]}):Object(h.jsxs)(m.a,{children:[Object(h.jsx)(m.a.Row,{children:Object(h.jsx)(m.a.Column,{children:Object(h.jsx)(E,{handleLogout:n,loggedUser:t})})}),Object(h.jsx)(m.a.Row,{children:Object(h.jsx)(m.a.Column,{children:Object(h.jsx)(M,{user:g})})}),Object(h.jsx)(m.a.Row,{centered:!0,children:Object(h.jsx)(m.a.Column,{style:{maxWidth:750},children:Object(h.jsx)(z,{posts:i,loggedUser:t,handleDeletePost:function(e){return U.apply(this,arguments)}})})})]})}var G=function(){var e=Object(r.useState)(f.getUser()),t=Object(c.a)(e,2),n=t[0],a=t[1];function o(){a(f.getUser())}function l(){f.logout(),a(null)}return n?Object(h.jsxs)(s.d,{children:[Object(h.jsx)(s.b,{path:"/:username",element:Object(h.jsx)(_,{loggedUser:n,handleLogout:l})}),Object(h.jsx)(s.b,{path:"/",element:Object(h.jsx)(J,{loggedUser:n,handleLogout:l})}),Object(h.jsx)(s.b,{path:"/posts/:id",element:Object(h.jsx)(H,{loggedUser:n,handleLogout:l})}),Object(h.jsx)(s.b,{path:"/login",element:Object(h.jsx)(C,{handleSignUpOrLogin:o})}),Object(h.jsx)(s.b,{path:"/signup",element:Object(h.jsx)(S,{handleSignUpOrLogin:o})})]}):Object(h.jsxs)(s.d,{children:[Object(h.jsx)(s.b,{path:"/login",element:Object(h.jsx)(C,{handleSignUpOrLogin:o})}),Object(h.jsx)(s.b,{path:"/signup",element:Object(h.jsx)(S,{handleSignUpOrLogin:o})}),Object(h.jsx)(s.b,{path:"/*",element:Object(h.jsx)(s.a,{to:"/login"})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(h.jsx)(x.a,{children:Object(h.jsx)(G,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[602,1,2]]]);
//# sourceMappingURL=main.2061260e.chunk.js.map